
				RBOOK
		      ПРОГРАММА ДЛЯ ЧТЕНИЯ КНИГ

Программа Rbook работает в среде Emacs и позволяет читать книги,
представленные в электронном виде, при помощи синтезатора речи,
обеспечивая возможность немедленного останова процесса чтения с
последующим его возобновлением и использование механизма закладок.

Первоначальный вариант этой программы принадлежит перу Дмитрия
Падучих, за что, пользуясь случаем, хочу выразить ему глубочайшую
благодарность. Я лишь несколько модифицировал ее, оснастив
возможностью создания аудиокниг в MP3-формате, пригодных для
прослушивания при помощи портативного плеера.


			      УСТАНОВКА

В принципе, все достаточно тривиально. Файл rbook.el, содержащий
лисповский модуль программы, следует положить туда, где Emacs привык
искать подобные вещи, например, в /usr/share/emacs/site-lisp. Этот
файл можно подвергнуть байт-компиляции, однако, учитывая невеликие его
размеры и мощь современных компьютеров, вряд ли шаг этот можно считать
необходимым. Остальные файлы, составляющие пакет, - play, mp3, speak,
progress.au, task-done.au, - следует разместить в каталоге
/usr/local/lib/rbook. Можно, конечно, разложить эти файлы и по другим
местам, но в этом случае придется соответствующим образом
скорректировать пути к ним в rbook.el. Файлы speak, mp3 и play - это
исполняемые скрипты, то есть необходимо, чтобы атрибут разрешения
исполнения для них был установлен.

И, наконец, в какой-нибудь из файлов, выполняемых при загрузке Emacs,
например, в ~/.emacs или /usr/share/emacs/site-lisp/default.el,
рекомендуется вписать следующий текст:

(autoload 'rbook-read-text "rbook" nil t)
(autoload 'rbook-read-bookmark "rbook" nil t)
(autoload 'rbook-make-audio-book "rbook" nil t)
(autoload 'rbook-show-time "rbook" nil t)
(autoload 'rbook-customize "rbook" nil t)
(global-set-key (kbd "C-c b") 'rbook-read-bookmark)
(global-set-key (kbd "C-c r") 'rbook-read-text)
(global-set-key (kbd "C-c a") 'rbook-make-audio-book)
(global-set-key (kbd "C-c t") 'rbook-show-time)
(global-set-key (kbd "C-c c") 'rbook-customize)

Разумеется, можно использовать и другие горячие клавиши. А если не
полениться, то к этому можно добавить еще и такое:

(setq rbook-menu (make-sparse-keymap "RBOOK"))
(define-key global-map [menu-bar tools RBOOK] (cons "Book reader" rbook-menu))
(define-key global-map [menu-bar tools RBOOK customize] '("Customize parameters" . rbook-customize))
(define-key global-map [menu-bar tools RBOOK show-time] '("Show processed time" . rbook-show-time))
(define-key global-map [menu-bar tools RBOOK make-audio-book] '("Make audio book" . rbook-make-audio-book))
(define-key global-map [menu-bar tools RBOOK read-bookmark] '("Read text from bookmark" . rbook-read-bookmark))
(define-key global-map [menu-bar tools RBOOK read-text] '("Read text from cursor" . rbook-read-text))

В этом случае программа будет доступна также и через меню. А именно, в
разделе "Tools" появится пункт "Book reader".


ИСПОЛЬЗОВАНИЕ

Для чтения книг вслух при помощи речевого синтезатора служат следующие
два обращения:

`C-c r' (rbook-read-text) -- Читать текст в текущем буфере с текущей
позиции.

`C-c b' (rbook-read-bookmark) -- Читать текст, начиная от закладки. По
умолчанию используется закладка `book', однако, если вызывать эту
функцию с префиксным аргументом, то можно явно задать имя закладки.

Процесс чтения может быть мгновенно прерван в любой момент посредством
стандартной комбинации `C-g'. При этом курсор устанавливается на
начало того предложения, чтение которого было столь грубо прервано. В
случае чтения с закладки в это же место будет переложена и
закладка. Таким образом, при последующем использовании описанных
обращений чтение может быть продолжено.

Примечание. Rbook использует входящий в состав Emacs механизм закладок
(`bookmark'), детально описанный в документации на Emacs, потому
останавливаться на нем здесь подробно не вижу смысла.

Комбинация клавиш `C-c c' (rbook-customize) вызывает панель настройки,
при помощи которой можно установить целый ряд параметров программы,
таких как, например, скорость речи, тембр и громкость голоса и многое
другое.

Нажатие `C-c a' (rbook-make-audio-book) запускает процесс изготовление
аудиокниги из текста, содержащегося в текущем буфере. Чтение
начинается с текущей позиции курсора. Процесс этот сопровождается
перемещением курсора по тексту и периодической выдачей сообщений о
времени звучания обработанного текста. Процесс завершается по
достижении конца буфера или может быть остановлен насильно путем
уничтожения буфера с текстом. В последнем случае прекращение процесса
происходит не мгновенно, так как текущее предложение дочитывается
обязательно. По окончании процесса изготовления аудиокниги выдается
сообщение о времени ее звучания и о суммарном объеме файлов.

Время звучания обработанного текста можно получить и по желанию в
любой момент при помощи комбинации `C-c t' (rbook-show-time).

Для успешного создания аудиокниг желательно чтобы исходный текст
удовлетворял следующим условиям:

1) Заголовки должны отделяться от основного текста пустыми строками.

2) Абзацы должны отделяться друг от друга пустыми строками.

3) В тексте не должно быть многоточий внутри слов. Если же таковые
   встречаются, то справа от многоточия в таких местах следует
   вставить пробел.

При изготовлении аудиокниг часто бывает целесообразно разбивать их на
куски по тем или иным критериям, вместо того, чтобы создавать единый
большой файл. Rbook располагает достаточно гибким механизмом такой
разбивки, позволяющий ориентироваться как на логику текста, так и на
время звучания отдельных файлов. Однако, независимо от критерия,
разбиение всегда происходит на границе абзацев.


					Порецкий Игорь
					<root@goga.energo.ru>
